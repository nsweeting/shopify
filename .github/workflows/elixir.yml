name: Elixir CI

on: push

jobs:
  build:

    runs-on: ubuntu-latest

    strategy:
      matrix:
        # Elixir supports security patches for the most recent 5 versions. See
        # https://github.com/elixir-lang/elixir/blob/master/lib/elixir/pages/Compatibility%20and%20Deprecations.md
        elixir_container: [alpine, 1.9-alpine, 1.8-alpine, 1.7-alpine, 1.6-alpine, 1.5-alpine]

    container:
      image: elixir:${{ matrix.elixir_container }}

    steps:
    - uses: actions/checkout@v1
    - name: Install Dependencies
      run: |
        mix local.rebar --force
        mix local.hex --force
        mix deps.get
    - name: Run Tests
      run: mix test
